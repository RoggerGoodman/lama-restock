<!-- LamApp/supermarkets/templates/blacklists/detail.html -->
{% extends 'base.html' %}
{% block title %}Blacklist: {{ blacklist.name }}{% endblock %}
{% block page_title %}{{ blacklist.name }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Breadcrumb -->
    <div class="row mb-4">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'blacklist-list' %}">Blacklists</a></li>
                    <li class="breadcrumb-item active">{{ blacklist.name }}</li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- Blacklist Info -->
    <div class="row mb-4">
        <div class="col-lg-8">
            <div class="stat-card">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                        <h4 class="mb-1">
                            <i class="bi bi-slash-circle text-danger"></i>
                            {{ blacklist.name }}
                        </h4>
                        <p class="text-muted mb-0">
                            <i class="bi bi-box"></i> {{ blacklist.storage.name }}
                            <span class="text-muted mx-2">|</span>
                            <i class="bi bi-shop"></i> {{ blacklist.storage.supermarket.name }}
                        </p>
                    </div>
                </div>

                {% if blacklist.description %}
                <div class="alert alert-info mb-3">
                    {{ blacklist.description }}
                </div>
                {% endif %}

                <!-- Actions -->
                <div class="d-flex gap-2 mb-3">
                    <a href="{% url 'blacklistentry-add' blacklist_pk=blacklist.pk %}" class="btn btn-primary">
                        <i class="bi bi-plus-circle"></i> Aggiungi articolo
                    </a>
                    <a href="{% url 'blacklist-delete' pk=blacklist.pk %}" class="btn btn-outline-danger">
                        <i class="bi bi-trash"></i> Elimina Blacklist
                    </a>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="stat-card">
                <h6 class="mb-3">Statistiche</h6>
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted">Totale articoli</span>
                    <strong>{{ blacklist.entries.count }}</strong>
                </div>
                <div class="d-flex justify-content-between align-items-center">
                    <span class="text-muted">Data creazione</span>
                    <strong>{{ blacklist.created_at|date:"d/m/Y" }}</strong>
                </div>
            </div>
        </div>
    </div>

    <!-- Entries List -->
    <div class="row">
        <div class="col-12">
            <div class="stat-card">
                <h5 class="mb-3">
                    <i class="bi bi-list-check"></i> Articoli in Blacklist
                </h5>

                {% if entries_with_desc %}
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Codice Articolo</th>
                                    <th>Descrizione</th>
                                    <th>Azioni</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for entry in entries_with_desc %}
                                <tr>
                                    <td><strong>{{ entry.product_code }}.{{ entry.product_var }}</strong></td>
                                    <td>{{ entry.description|default:"-" }}</td>
                                    <td>
                                        <a href="{% url 'blacklistentry-delete' pk=entry.pk %}" class="btn btn-sm btn-outline-danger">
                                            <i class="bi bi-trash"></i> Rimuovi
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-secondary mt-3">
                        <i class="bi bi-info-circle"></i>
                        <strong>{{ blacklist.entries.count }}</strong> articol{{ blacklist.entries.count|pluralize:"o,i" }} verr{{ blacklist.entries.count|pluralize:"Ã ,anno" }} esclus{{ blacklist.entries.count|pluralize:"o,i" }} dagli ordini di restock.
                    </div>
                {% else %}
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i>
                        Nessun articolo in questa blacklist.
                        <a href="{% url 'blacklistentry-add' blacklist_pk=blacklist.pk %}" class="alert-link">Aggiungi il primo articolo</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
